---
layout: ../../../layouts/DocsLayout.astro
title: Filtering - HypeQuery Documentation
---

# Advanced Filtering

hypequery provides powerful filtering capabilities through the `CrossFilter` class and direct query methods. This guide covers all the filtering options available.

## Basic Filtering

Use the `where` method for simple conditions:

```typescript
const results = await db
  .table('users')
  .where('age', 'gt', 18)
  .where('status', 'eq', 'active')
  .execute();
```

## OR Conditions

Use `orWhere` for OR conditions:

```typescript
const results = await db
  .table('users')
  .where('status', 'eq', 'active')
  .orWhere('role', 'eq', 'admin')
  .execute();
```

## Complex Filtering with CrossFilter

The `CrossFilter` class provides more advanced filtering capabilities:

```typescript
const filter = new CrossFilter()
  .add({
    column: 'status',
    operator: 'in',
    value: ['active', 'pending']
  })
  .addGroup([
    {
      column: 'created_at',
      operator: 'gte',
      value: new Date('2023-01-01')
    },
    {
      column: 'total',
      operator: 'gt',
      value: 1000
    }
  ], 'OR');

const results = await db
  .table('orders')
  .applyCrossFilters(filter)
  .execute();
```

## Date Filtering

Special methods for date-based filtering:

```typescript
const filter = new CrossFilter()
  .addDateRange('created_at', 'last_30_days')
  .addDateRange('updated_at', 'this_month');

// Or use custom date ranges
filter.lastNDays('created_at', 7);

// Compare periods
filter.addComparisonPeriod('created_at', [startDate, endDate]);
```

### Available Date Ranges

- `today`
- `yesterday`
- `last_7_days`
- `last_30_days`
- `this_month`
- `last_month`
- `this_quarter`
- `year_to_date`

## Top N Filtering

Get the top N records by a value:

```typescript
const filter = new CrossFilter()
  .topN('amount', 10, 'desc'); // Top 10 by amount

const results = await db
  .table('orders')
  .applyCrossFilters(filter)
  .execute();
```

## Filter Operators

All available filter operators:

```typescript
// Comparison operators
filter.add({ column: 'age', operator: 'eq', value: 25 });    // equals
filter.add({ column: 'age', operator: 'neq', value: 25 });   // not equals
filter.add({ column: 'age', operator: 'gt', value: 18 });    // greater than
filter.add({ column: 'age', operator: 'gte', value: 18 });   // greater than or equal
filter.add({ column: 'age', operator: 'lt', value: 65 });    // less than
filter.add({ column: 'age', operator: 'lte', value: 65 });   // less than or equal

// Array operators
filter.add({ column: 'status', operator: 'in', value: ['active', 'pending'] });
filter.add({ column: 'status', operator: 'notIn', value: ['deleted', 'banned'] });

// Range operator
filter.add({ column: 'amount', operator: 'between', value: [100, 1000] });

// Pattern matching
filter.add({ column: 'name', operator: 'like', value: '%John%' });
```

## Type Safety

Filters are type-safe based on your schema:

```typescript
interface Schema {
  users: {
    age: 'Int32';
    name: 'String';
    created_at: 'Date';
  }
}

const filter = new CrossFilter<Schema>();

// TypeScript will catch these errors:
filter.add({ column: 'invalid', operator: 'eq', value: 123 }); // Error: invalid column
filter.add({ column: 'age', operator: 'eq', value: 'invalid' }); // Error: age expects number
filter.addDateRange('name', 'today'); // Error: name is not a date column
``` 